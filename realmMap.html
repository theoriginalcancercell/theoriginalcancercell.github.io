<!DOCTYPE html>
<html>
  <head>
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
      integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
      crossorigin=""
    />

    <style>
      #map {
        background: #202020;
        font-size: 16px;
      }

      body,
      html,
      #map {
        margin: 0px;
        width: 100%;
        height: 100%;
      }

      #coords {
        background: white;
        position: absolute;
        bottom: 0;
        left: 0;
        display: block;
        z-index: 800;
      }

      .leaflet-tile {
        border: solid red 0px;
      }
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>

  <body margin="0" padding="0">
    <script
      src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
      integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
      crossorigin=""
    ></script>
    <div id="map">
      <div id="coords">Click, Tap, or Move Mouse for coordinates</div>
    </div>
    <script>
      var layers = {
        dim0: {
          name: "Overworld",
          attribution:
            '<a href="https://github.com/mjungnickel18/papyruscs">PapyrusCS</a>',
          minNativeZoom: 15,
          minZoom: 15,
          maxNativeZoom: 20,
          maxZoom: 22,
          noWrap: true,
          tileSize: 512,
          folder: "dim0",
          fileExtension: "png"
        }
      };

      var config = {
        factor: 1
      };

      layers = {"dim0":{"name":"Overworld","attribution":"Generated by <a href=\"https://github.com/mjungnickel18/papyruscs\">PapyrusCS</a>","minNativeZoom":11,"maxNativeZoom":20,"noWrap":true,"tileSize":512,"folder":"dim0","fileExtension":"webp"}}; 
config = {"factor":65536.0,"globalMinZoom":11,"globalMaxZoom":20,"tileSize":512,"blocksPerTile":32};

      // ======

      var map = L.map("map", {
        crs: L.CRS.Simple
      });

      var baseMaps = {};
      var hasOverworld = false;
      for (var layerName of Object.keys(layers)) {
        var layer = layers[layerName];
        if (layer.name === "Overworld") {
          hasOverworld = true;
        }
        baseMaps[layer.name] = L.tileLayer(
          "./" + layer.folder + "/{z}/{x}/{y}." + layer.fileExtension,
          {
            attribution: layer.attribution,
            minNativeZoom: layer.minNativeZoom,
            minZoom: layer.minZoom,
            maxNativeZoom: layer.maxNativeZoom,
            maxZoom: layer.maxZoom,
            noWrap: true,
            tileSize: layer.tileSize
          }
        );
      }

      L.control.layers(baseMaps).addTo(map);

      if (hasOverworld) {
        baseMaps["Overworld"].addTo(map);
      } else {
        baseMaps[Object.keys(baseMaps)[0]].addTo(map);
      }

      map.setView([0, 0], config.globalMinZoom);

      function display_coordinates(event) {
        var myDiv = document.getElementById("coords");
        var factor = config.factor;

        myDiv.innerHTML =
          "X: " +
          Math.floor(event.latlng.lng * factor) +
          " Z: " +
          (-1 - Math.floor(event.latlng.lat * factor));
      }

      map.on("mousemove", display_coordinates);
      map.on("click", display_coordinates);
    </script>
  </body>
</html>
